<head>
  <title>Socket.io Example</title>

</head>

<body>
  <style>
    #notificationModal {
      z-index: 99999;
      bottom: 20px;
      right: 20px;
    }

    .modal-content {
      background-color: rgba(0, 0, 0, 0.5) !important;
      box-shadow: none;
    }
  </style>
  <form action="/send" method="POST">
    <input type="text" name="message">
    <button type="submit">Send</button>
  </form>

  <!-- 모달창을 위한 HTML 코드 -->
  <div class="modal fade" id="notificationModal" tabindex="-1" role="dialog" aria-labelledby="notificationModalLabel"
    aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="notificationModalLabel">알림</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <p id="notificationMessage"></p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-dismiss="modal">닫기</button>
        </div>
      </div>
    </div>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    // import Swal from 'sweetalert2';
    // const socket = io();
    // socket.on('connect', function() {
    //   console.log('소켓 연결됨');
    // });
    // socket.on('message', function(data) {
    //   console.log(data);
    // });
    const socket = io();
    socket.on("connect", () => {
      socket.send("Hello!");
    });

    socket.on("message", (data) => {
      console.log("안녕 난 백에서 보낸 데이터야", data);
    });

    socket.on("RESERVATIONS", (data) => {
      console.log("커스텀 이벤트 네임이다.", data);
    });

    socket.on('RESERVATIONS', (data) => {
      // 모달창에 알림 표시
      const message =
        `${data.name}님의 예약이 완료되었습니다.<br>관계: ${data.relationship}<br>전화번호: ${data.phone}<br>예약일자: ${data.reservationdate}<br>예약시간: ${data.reservationtime}`;
      $('#notificationMessage').html(message);
      $('#notificationModal').modal('show');
      // makeNotification(message)
    });

    function makeNotification(message) {
      // 모달창을 복제하여 새로운 모달창 생성
      const newModal = $('#notificationModal').clone();
      newModal.attr('id', `notificationModal_${Date.now()}`); // 고유한 id 부여

      // 모달창 내용 설정
      newModal.find('#notificationMessage').html(message);

      // 모달창 열기
      newModal.modal('show');
    }

    // socket.on('RESERVATIONS', (data) => {
    //       // SweetAlert2 라이브러리를 사용하여 알림 표시
    //       //   Swal.fire({
    //       //     icon: 'success',
    //       //     title: '예약 완료!',
    //       //     text: `${data.name}님의 예약이 완료되었습니다.`,
    //       //   });
    //       // });

    //       socket.emit("customEventName", "this is custom event data");
    // 브라우저가 Notification을 지원하는지 확인합니다.
  </script>
</body>
