<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>Î°úÍ∑∏Ïù∏</title>
    </head>

    <body>
        <div id="main">
            <div class="inner">
                <div style="margin-top: 100px">
                    <section>
                        <!-- <h2 style="margin-left: 100px;">Î°úÍ∑∏Ïù∏</h2> -->
                        <form method="post" action="">
                            <div class="row gtr-uniform" style="display: block">
                                <div class="col-5 col-12-xsmall" id="Id" style="margin: 0 auto">
                                    <input
                                        type="email"
                                        name="loginId"
                                        id="loginId"
                                        value=""
                                        placeholder="Email"
                                    />
                                </div>
                                <div class="col-5 col-12-xsmall" id="pw" style="margin: 0 auto">
                                    <input
                                        type="password"
                                        name="password"
                                        id="password"
                                        onkeypress="javascript:if(event.keyCode===13) {loginData()}"
                                        value=""
                                        placeholder="password"
                                    />
                                </div>
                            </div>
                        </form>
                    </section>
                    <div style="text-align: center">
                        <input
                            type="button"
                            class="button login__submit"
                            id="login"
                            value="Î°úÍ∑∏Ïù∏"
                            style="width: 150px; display: inline-block"
                            onclick="loginData()"
                        />
                    </div>
                    <div style="margin-top: 40px">
                        <p style="text-align: center; margin-bottom: 0px; font-size: 14px">
                            <a href="/findmypassword">ÎπÑÎ∞ÄÎ≤àÌò∏Î•º ÏûäÏúºÏÖ®ÎÇòÏöî?</a>
                        </p>
                        <p style="text-align: center; font-size: 14px">
                            <a href="/signup">Í≥ÑÏ†ïÏù¥ ÏóÜÏúºÏã†Í∞ÄÏöî?</a>
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <script>
            function loginData() {
                const login = document.getElementById('login').value;
                const data = {
                    loginId: document.getElementById('loginId').value,
                    password: document.getElementById('password').value,
                };

                if (data.loginId === '' || data.password === '') {
                    swal({
                        title: '‚úç ÏûÖÎ†•Ï†ïÎ≥¥ Ï∂îÍ∞ÄÏöîÎßù!',
                        text: 'Ï†ïÎ≥¥Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî',
                        icon: 'info',
                    }).then(() => {
                        return;
                    });
                } else {
                    fetch('/api/users/login', {
                        credentials: 'include',
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(data), //
                    })
                        .then((response) => {
                            //ÏöîÏ≤≠Ìïú api ÏùëÎãµÏù¥ Îì§Ïñ¥ÏôîÏùÑ Îïå Ïã§ÌñâÎê®
                            if (response.status === 500) {
                                //ÏóêÎü¨Ï≤òÎ¶¨ Ìï¥Ï§Ä status Í∏∞ÏûÖ
                                swal({
                                    title: 'üòì Ï£ÑÏÜ°Ìï©ÎãàÎã§.',
                                    text: 'Ïù¥Î©îÏùº ÎòêÎäî Ïù¥Î©îÏùºÏùò ÏñëÏãùÏù¥ Îã§Î¶ÖÎãàÎã§.',
                                    icon: 'warning',
                                }).then(() => {
                                    window.location.reload();
                                });
                            } else if (response.status === 412) {
                                swal({
                                    title: 'üòì Ï£ÑÏÜ°Ìï©ÎãàÎã§.',
                                    text: 'ÎπÑÎ∞ÄÎ≤àÌò∏Í∞Ä ÌãÄÎ†∏ÏäµÎãàÎã§.',
                                    icon: 'warning',
                                }).then(() => {
                                    window.location.reload();
                                });
                            } else if (response.status === 200) {
                                swal({
                                    title: 'üòä Î°úÍ∑∏Ïù∏ ÏÑ±Í≥µ!',
                                    text: 'Î°úÍ∑∏Ïù∏Ïóê ÏÑ±Í≥µÌïòÏòÄÏäµÎãàÎã§.',
                                    icon: 'success',
                                }).then(() => {
                                    location.href = '/';
                                });
                            }
                        })
                        .catch((err) => {
                            swal({
                                title: 'üò≠ Î°úÍ∑∏Ïù∏ Ïã§Ìå®',
                                text: err.message,
                                icon: 'error',
                            }).then(() => {
                                window.location.reload();
                            });
                        });
                }
            }
        </script>
    </body>
</html>
