<style>
    /* ì˜ì‚¬ í”„ë¡œí•„ ì¹´ë“œ*/
    .profile-card {
        background-color: white;
        border-radius: 5px;
        box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
        padding: 20px;
        width: 300px;
        margin: 50px auto;
    }

    .profile-card img {
        width: 100%;
        border-radius: 5px 5px 0 0;
    }

    .profile-card h1 {
        font-size: 24px;
        margin-top: 0;
    }

    .profile-card p {
        font-size: 16px;
        color: #777;
    }
</style>
<h1>ì˜ì‚¬ ì •ë³´ ìˆ˜ì •</h1>
<form id="form">
    <div class="profile-card" id="profile-card">
        <label for="profile-image-upload" class="custom-file-upload">í”„ë¡œí•„ ì‚¬ì§„ ë³€ê²½</label>
        <input id="image" type="file" name="image" required />
        <img src="" alt="ì˜ì‚¬ ì‚¬ì§„" />
        <div class="info">
            <div class="input-container">
                <label for="name">ì´ë¦„</label>
                <input type="text" id="name" name="name" required />
            </div>
            <div class="input-container">
                <label for="contents">ì†Œê°œê¸€</label>
                <textarea id="contents" name="contents" required></textarea>
            </div>
            <div class="dates">
                <p class="created-at"></p>
                <p class="updated-at"></p>
            </div>
        </div>
        <button type="submit">ìˆ˜ì •í•˜ê¸°</button>
    </div>
</form>

<script>
    $(document).ready(function () {
        informationDoctor();
    });

    function informationDoctor() {
        const urlParams = new URLSearchParams(window.location.search); // url ì£¼ì†Œ paramsë¥¼ ê°€ì ¸ì˜´
        const doctorId = urlParams.get('doctorId');

        $.ajax({
            type: 'GET',
            url: `/api/hospitals/information/doctor/${doctorId}`,
            dataType: 'json',
            success: function (response) {
                const doctor = response;
                // ì˜ì‚¬ ì •ë³´ë¥¼ formì— ì‚½ì…
                $('.profile-card img').attr('src', doctor.image); // attr JQuery ë©”ì„œë“œ
                $('#name').val(doctor.name);
                $('#contents').val(doctor.contents);
                $('.profile-card .info .created-at').text(`Created At: ${doctor.createdAt}`);
                $('.profile-card .info .updated-at').text(`Updated At: ${doctor.updatedAt}`);
            },
        });
    }

    $('#form').submit(function (e) {
        e.preventDefault(); // ê¸°ë³¸ ì´ë²¤íŠ¸ ë§‰ê¸°

        const formData = new FormData(this); // form ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        const urlParams = new URLSearchParams(window.location.search); // url ì£¼ì†Œ paramsë¥¼ ê°€ì ¸ì˜´
        const doctorId = urlParams.get('doctorId');
        $.ajax({
            type: 'PUT', // ìˆ˜ì • ìš”ì²­
            url: `/api/hospitals/edit/doctor/${doctorId}`,
            data: formData, // form ë°ì´í„° ì „ì†¡
            contentType: false, // ë°ì´í„° ì „ì†¡ í˜•ì‹ ì§€ì • ì•ˆí•¨
            processData: false, // ë°ì´í„° ì²˜ë¦¬ ì•ˆí•¨
            success: function (response) {
                swal('ğŸ˜Š ì˜ì‚¬ ì •ë³´ ìˆ˜ì • ì„±ê³µ!', 'ì˜ì‚¬ ì •ë³´ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                // ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ëœ ê²½ìš° ì²˜ë¦¬í•  ë‚´ìš©ì„ ì‘ì„±

                window.location.href = '/hospital';
                // alert ì´í›„ ë³‘ì› ê´€ë¦¬í˜ì´ì§€ë¡œ ì´ë™
            },
            error: function (xhr) {
                swal('ğŸ˜­ ì˜ì‚¬ ì •ë³´ ìˆ˜ì • ì‹¤íŒ¨', 'ì˜ì‚¬ ì •ë³´ ìˆ˜ì •ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.', 'error');
                // ìˆ˜ì •ì— ì‹¤íŒ¨í•œ ê²½ìš° ì²˜ë¦¬í•  ë‚´ìš©ì„ ì‘ì„±
            },
        });
    });
</script>
